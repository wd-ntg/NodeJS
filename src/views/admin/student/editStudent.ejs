<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/roomPrac.css" />
    <title>Document</title>
   <style>
        h2 {
        margin: 10px;
        text-align: center;
        color: red;
    }
   </style>
</head>
<body>
    <div class="modal-container">
        <div style="display: block;" id="myModal" class="modal">
            <div class="modal-content">
            <a href="/manage-student" class="close">&times;</a>
            <div class="create-room">
                <h2><%=error %></h2>
                <form class="modal__form" action="/post-edit-student" method="POST">
                    <div class="modal__item-wrap">
                        <span class="modal__manager-name"> Chỉnh sửa thông tin sinh viên </span>
                    </div>
                    <div class="modal__content-wrap">
                        <div class="modal__item-wrap">
                            <label class="modal__item-label">Tên sinh viên</label>
                            <input value="<%=data.name%>" class="modal__item-input" valid="tên sinh viên" type="text" name="name" />
                        </div>
                        <div class="modal__item-wrap">
                            <label class="modal__item-label">Email</label>
                            <input value="<%=data.email%>" class="modal__item-input" valid="email" type="email" name="email" />
                        </div>
                        <div class="modal__item-wrap">
                            <label class="modal__item-label">Mật khẩu</label>
                            <input value="<%=data.password%>" class="modal__item-input" valid="mật khẩu" type="password" name="password" />
                        </div>
                        <div class="modal__item-wrap">
                            <label class="modal__item-label">Lớp</label>
                            <input value="<%=data.className%>" class="modal__item-input" valid="lớp" type="text" name="className" />
                        </div>
                        <div class="modal__item-wrap">
                            <label class="modal__item-label">MSSV</label>
                            <input value="<%=data.mssv%>" class="modal__item-input" valid="mã số sinh viên" type="text" name="mssv" />
                        </div>
                        <div class="modal__item-wrap gender-option">
                            <label class="modal__item-label">Giới tính: </label>
                            <% for (let i=0; i< gender.length; i++) { %>
                                <div class="option-item">
                                    <input 
                                    class="input_gender" type="radio" name="gender" value="<%=gender[i].code %>"
                                    <% if (data.gender === gender[i].code) { %>
                                        checked
                                      <% } %>
                                    />
                                    <label><%=gender[i].keyName %></label>
                                </div>        
                            <% } %>
                        <div>
                            <input type="text" hidden value="<%= data.id %>" name="id" />
                        </div>
                        
                            <!-- <input class="modal__item-input" valid="giới tính" type="text" name="gender" /> -->
                        </div>

                        <div class="modal__item-wrap">
                            <button class="modal__item-button" type="submit">Lưu</button>
                        </div>
                    </div>
                    
                </form>
            </div>
        </div>
    </div>
    <script>
        let btnSave = document.querySelector('.modal__item-button');
            let inputs = document.querySelectorAll('.modal__item-input');
            let inputsGender = document.querySelectorAll('.input_gender');

            btnSave.onclick = (e) => {
                let isValid = true;
                for (let i = 0; i < inputs.length; i++) {
                    if (!inputs[i].value) {
                        let valueError = inputs[i].getAttribute('valid');
                        alert(`Vui lòng nhập ${valueError}`);
                        isValid = false;
                        break;
                    } else if (inputs[i].name === 'email') {
                        let regexEmail = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;

                        let checkEmail = regexEmail.test(inputs[i].value);

                        if (!checkEmail) {
                            alert('Email không đúng định dạng, vui lòng nhập lại!');
                            isValid = false;
                            break;
                        }
                    } else if (inputs[i].name === 'password') {
                        if (inputs[i].value.length < 6) {
                            alert('Mật khẩu phải dài hơn 6 ký tự, vui lòng nhập lại!');
                            isValid = false;
                            break;
                        }
                    }
                }

                let isGenderCheck = false;
                if (isValid) {
                    for (let i = 0; i < inputsGender.length; i++) {
                        if (inputsGender[i].checked) {
                            isGenderCheck = true;
                        }
                    }

                    if (!isGenderCheck) {
                        alert('Vui lòng nhập giới tính của sinh viên');
                        isValid = false;
                    }
                }

                if (!isValid) {
                    e.preventDefault();
                }}
    </script>
</body>
</html>
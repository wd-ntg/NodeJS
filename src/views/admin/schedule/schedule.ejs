<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="/css/roomPrac.css" />
        <title>Document</title>
        <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css" />
        <style>
            .w3-bar-item {
                border-right: 1px solid #ccc !important;
            }
            .w3-bar-item.active {
                background-color: #00b158;
                color: #fff;
            }
        </style>
    </head>
    <body>
        <div class="room-container">
            <div class="w3-bar w3-border-bottom w3-light-grey">
                <a href="/roomPrac" class="w3-bar-item w3-button">Phong thuc hanh</a>
                <a href="/roomLab" class="w3-bar-item w3-button">Phong thi nghiem</a>
                <a href="/history" class="w3-bar-item w3-button">Lich su</a>
                <a href="/manage-student" class="w3-bar-item w3-button">Quan ly sinh vien</a>
                <a href="/schedule" class="w3-bar-item w3-button active">Quan li lich hoc</a>
            </div>
            <div class="room-header">
                <h2>Quan li lich hoc</h2>
            </div>
            <div class="room-body">
                <div class="add-room">
                    <a href="/views-add/schedule" class="add-room-btn" style="text-decoration: none"
                        >Thêm mới lich hoc</a
                    >
                </div>
                <div class="room-list">
                    <table id="customers">
                        <thead>
                            <tr>
                                <th>STT</th>
                                <th>Tên phòng</th>
                                <th>Mã phòng</th>
                                <th>Số lượng sinh viên tối đa</th>
                                <th>Số lượng sinh viên hiện tại</th>
                                <th>Thời gian</th>
                                <th>Các thao tác</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% for (let i=0; i< data.length; i++) { %>

                            <tr>
                                <td><%= i + 1 %></td>
                                <td><%=data[i].name %></td>
                                <td><%=data[i].roomCode %></td>
                                <td><%=data[i].max_student %></td>
                                <td><%=data[i].current_student %></td>
                                <td><%=data[i].keyName %> <%=data[i].time %></td>

                                <td style="display: flex; gap: 15px">
                                    <form action="/edit-schedule" method="POST">
                                        <input type="text" hidden value="<%= data[i].id %>" name="id" />
                                        <button class="room-action edit editBtn" type="submit">Edit</button>
                                    </form>
                                    <form action="/delete-schedule" method="POST">
                                        <input type="text" hidden value="<%= data[i].id %>" name="id" />
                                        <button class="room-action delete deleteBtn" type="submit">Delete</button>
                                    </form>
                                </td>
                            </tr>
                            <% } %>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>

        <% if (error) { %>
            <div class="modal-container" >
                <div style="display: block; " id="myModal" class="modal">
                    <div class="modal-content" style="min-height: 100px;">
                    <a href="/schedule" class="close">&times;</a>
                    <div class="create-room">
                        <h2 style="color: red; text-align: center;"><%=error %></h2>           
                    </div>
                </div>
            </div>
        <% }   %>  
          
        
        <script>
            let deleteBtn = document.querySelectorAll('.deleteBtn') 

            deleteBtn.forEach(item => {
                item.onclick = (e) => {
                    let isConfirm = confirm('Bạn có xác nhận xóa lịch học');
                    if (!isConfirm) {
                        e.preventDefault();
                    }
                }
            })
        </script>
        <!-- <script>
            // Get the modal
            let modal = document.getElementById('myModal');

            // Get the button that opens the modal
            let btn = document.getElementById('myBtn');

            // Get the <span> element that closes the modal
            let span = document.getElementsByClassName('close')[0];

            // When the user clicks the button, open the modal
            btn.onclick = function () {
                modal.style.display = 'block';
            };

            // When the user clicks on <span> (x), close the modal
            span.onclick = function () {
                modal.style.display = 'none';
            };

            // When the user clicks anywhere outside of the modal, close it
            window.onclick = function (event) {
                if (event.target == modal) {
                    modal.style.display = 'none';
                }
            };

            //Validate input
            let btnSave = document.querySelector('.modal__item-button');
            let inputs = document.querySelectorAll('.modal__item-input');
            let inputsGender = document.querySelectorAll('.input_gender');

            btnSave.onclick = (e) => {
                let isValid = true;
                for (let i = 0; i < inputs.length; i++) {
                    if (!inputs[i].value) {
                        let valueError = inputs[i].getAttribute('valid');
                        alert(`Vui lòng nhập ${valueError}`);
                        isValid = false;
                        break;
                    } else if (inputs[i].name === 'email') {
                        let regexEmail = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;

                        let checkEmail = regexEmail.test(inputs[i].value);

                        if (!checkEmail) {
                            alert('Email không đúng định dạng, vui lòng nhập lại!');
                            isValid = false;
                            break;
                        }
                    } else if (inputs[i].name === 'password') {
                        if (inputs[i].value.length < 6) {
                            alert('Mật khẩu phải dài hơn 6 ký tự, vui lòng nhập lại!');
                            isValid = false;
                            break;
                        }
                    }
                }

                let isGenderCheck = false;
                if (isValid) {
                    for (let i = 0; i < inputsGender.length; i++) {
                        if (inputsGender[i].checked) {
                            isGenderCheck = true;
                        }
                    }

                    if (!isGenderCheck) {
                        alert('Vui lòng nhập giới tính của sinh viên');
                        isValid = false;
                    }
                }

                if (!isValid) {
                    e.preventDefault();
                }
            };
        </script> -->
    </body>
</html>
